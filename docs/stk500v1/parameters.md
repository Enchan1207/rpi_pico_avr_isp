# STK500 v1 パラメータリファレンス

## 概要

このドキュメントでは、STK500 v1のコマンド `SetParameter (0x40)` および `GetParameter (0x41)` で設定・取得可能なパラメータとその詳細を説明します。

## 定義されているパラメータ

### Parm_STK_HW_VER

スターターキットハードウェアのバージョンを取得する。

- パラメータ番号: `0x80`
- 読み取り専用

### Parm_STK_SW_MAJOR

スターターキットMCUソフトウェアのメジャーバージョンを取得する。

- パラメータ番号: `0x81`
- 読み取り専用

### Parm_STK_SW_MINOR

スターターキットMCUソフトウェアのマイナーバージョンを取得する。

- パラメータ番号: `0x82`
- 読み取り専用

### Parm_STK_LEDS

スターターキットのステータスLEDを制御する。

- パラメータ番号: `0x83`
- 読み書き可能
- 設定値:
  - `0`: 全消灯
  - `1`: 緑色点灯
  - `2`: 赤色点灯
  - `3`: 緑色と赤色両方点灯 (黄色)

### Parm_STK_VTARGET

ターゲット電圧（VTARGET）を設定/取得する。

- パラメータ番号: `0x84`
- 読み書き可能
- 値の変換: 実際の電圧[V] = パラメータ値 / 10.0

### Parm_STK_VADJUST

調整可能電圧（AREF）を設定/取得する。

- パラメータ番号: `0x85`
- 読み書き可能
- 値の変換: 実際の電圧[V] = パラメータ値 / 10.0

### Parm_STK_OSC_PSCALE

調整可能オシレータのタイマープリスケーラ値を設定/取得する。

- パラメータ番号: `0x86`
- 読み書き可能
- 設定値と周波数の関係:
  - `0`: オシレータOFF
  - `1`: mcu_freq / ((Parm_STK_OSC_CMATCH + 1) × 1 × 2)
  - `2`: mcu_freq / ((Parm_STK_OSC_CMATCH + 1) × 8 × 2)
  - `3`: mcu_freq / ((Parm_STK_OSC_CMATCH + 1) × 32 × 2)
  - `4`: mcu_freq / ((Parm_STK_OSC_CMATCH + 1) × 64 × 2)
  - `5`: mcu_freq / ((Parm_STK_OSC_CMATCH + 1) × 128 × 2)
  - `6`: mcu_freq / ((Parm_STK_OSC_CMATCH + 1) × 256 × 2)
  - `7`: mcu_freq / ((Parm_STK_OSC_CMATCH + 1) × 1024 × 2)

### Parm_STK_OSC_CMATCH

調整可能オシレータのタイマーコンペアマッチ値を設定/取得する。

- パラメータ番号: `0x87`
- 読み書き可能
- 説明: `Parm_STK_OSC_PSCALE` と組み合わせてオシレータ周波数を決定

### Parm_STK_SCK_DURATION

ISP SCKクロックの半周期時間を設定/取得する。

- パラメータ番号: `0x89`
- 読み書き可能
- 設定基準: `Parm_STK_SCK_DURATION > (8×10^6 / target_freq) - 2`

### Parm_STK_BUFSIZEL / Parm_STK_BUFSIZEH

スターターキットMCUの通信バッファサイズを取得する。

- パラメータ番号:
  - 下位バイト: `0x90`
  - 上位バイト: `0x91`
- 読み取り専用
- 説明: 16ビット値として扱い、バッファサイズを表す

### Param_STK500_TOPCARD_DETECT

STK500に接続されているトップカードを検出する。

- パラメータ番号: `0x98`
- 読み取り専用
- 戻り値:
  - `0`: 将来使用のため予約
  - `1`: STK502検出
  - `2`: STK501検出
  - `3`: トップカード未検出

## 使用例

### パラメータ取得の例

ハードウェアバージョンを取得する場合:

```text
送信: <0x41> <0x80> <0x20>
受信: <0x14> <値> <0x10>
```

### パラメータ設定の例

ステータスLEDを緑色に設定する場合:

```text
送信: <0x40> <0x83> <0x01> <0x20>
受信: <0x14> <0x10>
```
